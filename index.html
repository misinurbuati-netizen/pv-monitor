<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ™ºæ…§å…‰ä¼ç”µç«™è¿ç»´ç³»ç»Ÿ - è¥¿åŒ—ç®¡æ§ä¸­å¿ƒ</title>
    <style>
        :root {
            --bg-dark: #06090f;
            --card-bg: #111621;
            --primary-blue: #00f2ff;
            --accent-green: #2ecc71;
            --warning-orange: #f39c12;
            --danger-red: #e74c3c;
            --border-color: #1e2736;
            --text-main: #e2e8f0;
        }

        body {
            background-color: var(--bg-dark);
            color: var(--text-main);
            font-family: 'PingFang SC', 'Microsoft YaHei', sans-serif;
            margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden;
        }

        /* é¡¶éƒ¨ç´§æ€¥å‘Šè­¦æµ®çª— - ä¿®å¤æ˜¾ç¤ºä¸å…¨é—®é¢˜ */
        #alert-popup {
            position: fixed; top: 10%; left: 50%; transform: translate(-50%, -50%);
            width: 80%; max-width: 600px; padding: 25px; border-radius: 12px;
            background: rgba(231, 76, 60, 0.98); color: white;
            font-weight: bold; text-align: center;
            display: none; z-index: 10000;
            box-shadow: 0 0 40px rgba(0,0,0,0.8);
            border: 3px solid #fff;
            line-height: 1.6;
        }

        header {
            padding: 12px 25px; background: #0f172a; border-bottom: 2px solid var(--primary-blue);
            display: flex; justify-content: space-between; align-items: center;
        }

        .logo { font-size: 20px; font-weight: bold; color: var(--primary-blue); letter-spacing: 1px; }

        main {
            display: grid; grid-template-columns: 350px 1fr 450px; gap: 15px;
            padding: 15px; flex: 1; overflow: hidden;
        }

        .column { display: flex; flex-direction: column; gap: 15px; height: 100%; overflow: hidden; }

        .card {
            background: var(--card-bg); border: 1px solid var(--border-color);
            border-radius: 10px; padding: 15px; display: flex; flex-direction: column; overflow: hidden;
        }

        .card-title {
            color: var(--primary-blue); font-size: 15px; font-weight: bold;
            margin-bottom: 12px; border-bottom: 1px solid var(--border-color); padding-bottom: 8px;
        }

        /* å¤©æ°”é¢æ¿ */
        .weather-info {
            background: linear-gradient(135deg, #1e293b, #0f172a);
            padding: 15px; border-radius: 8px; border: 1px solid #334155;
        }
        .temp-large { font-size: 32px; color: var(--primary-blue); font-weight: bold; }

        /* çŠ¶æ€æ ‡è®° - ä¿®å¤å›å½’ */
        .legend-bar {
            background: rgba(255,255,255,0.05); padding: 12px; border-radius: 6px;
            display: flex; gap: 20px; margin-bottom: 15px; font-size: 13px;
        }
        .legend-item { display: flex; align-items: center; gap: 8px; }
        .dot { width: 14px; height: 14px; border-radius: 3px; }

        /* ç½‘æ ¼ */
        .grid-wrapper {
            display: grid; grid-template-columns: repeat(10, 1fr); gap: 8px; overflow-y: auto; padding-right: 5px;
        }

        .panel {
            aspect-ratio: 1.1; border-radius: 4px; font-size: 11px;
            display: flex; align-items: center; justify-content: center;
            cursor: pointer; background: rgba(255,255,255,0.05); border: 1px solid #2d3748; transition: 0.3s;
        }
        .panel:hover { border-color: #fff; background: rgba(255,255,255,0.15); }
        .p-normal { border-color: var(--primary-blue); color: var(--primary-blue); }
        .p-dirty { border-color: var(--warning-orange); color: var(--warning-orange); background: rgba(243,156,18,0.15); }
        .p-error { border-color: var(--danger-red); color: var(--danger-red); animation: blink 1.5s infinite; }

        @keyframes blink { 50% { opacity: 0.2; } }

        .device-box {
            background: rgba(255,255,255,0.03); border-radius: 6px; padding: 12px;
            margin-bottom: 10px; border-left: 4px solid var(--primary-blue); font-size: 13px;
        }
        .working { border-left-color: var(--accent-green); background: rgba(46,204,113,0.1); }

        /* æ—¥å¿—åŒºåŸŸ - ä¿®æ­£æ»šåŠ¨ä¸æ—¥æœŸ */
        .log-scroll-area { flex: 1; overflow-y: auto; }
        table { width: 100%; border-collapse: collapse; font-size: 12px; }
        th { text-align: left; padding: 10px; color: #718096; position: sticky; top: 0; background: var(--card-bg); border-bottom: 1px solid var(--border-color); }
        td { padding: 10px 8px; border-bottom: 1px solid rgba(255,255,255,0.02); font-family: monospace; }
        .log-obj { color: var(--primary-blue); font-weight: bold; }
    </style>
</head>
<body>

<div id="alert-popup"></div>

<header>
    <div class="logo">è¥¿åŒ—åŸºåœ°æ™ºæ…§è¿ç»´å®æ—¶ç›‘æ§</div>
    <div id="clock" style="font-family: monospace; font-size: 16px;"></div>
</header>

<main>
    <div class="column">
        <div class="card">
            <div class="card-title">åŒºåŸŸå®æµ‹æ°”è±¡ (ç”˜è‚ƒé…’æ³‰)</div>
            <div class="weather-info">
                <div style="display: flex; justify-content: space-between;">
                    <span id="weather-cond" style="color:var(--warning-orange)">æµ®å°˜å¤©æ°”</span>
                    <span>è¥¿åŒ—é£ 5çº§</span>
                </div>
                <div style="margin: 10px 0;">
                    <span class="temp-large">14Â°C</span>
                    <span style="font-size: 14px; margin-left: 10px; color: #94a3b8;">æ¹¿åº¦ 18%</span>
                </div>
                <div style="font-size: 12px; color: #718096; line-height: 1.5;">
                    é¢„è­¦ï¼šé«˜é£é™©æ²™å°˜æ²‰ç§¯ã€‚å»ºè®®æ— äººæœºä½ç©ºä½œä¸šï¼Œå±¥å¸¦å°è½¦å¾…å‘½éšæ—¶ä»‹å…¥ã€‚
                </div>
            </div>
        </div>

        <div class="card" style="flex: 1;">
            <div class="card-title">è¿ç»´è®¾å¤‡çŠ¶æ€</div>
            <div class="device-box" id="uav-box">
                <b>æ— äººæœº (é«˜æ¸…å·¡æ£€)</b><br>
                çŠ¶æ€ï¼š<span style="color:var(--accent-green)">ä»»åŠ¡ä¸­ï¼šé…’æ³‰-03åŒºå·¡èˆª</span>
            </div>
            <div class="device-box" id="bot-box" style="border-left-color: var(--warning-orange);">
                <b>å±¥å¸¦å°è½¦ (æ™ºèƒ½é™¤å°˜)</b><br>
                çŠ¶æ€ï¼š<span id="bot-status">åŸºç«™å¾…å‘½</span>
            </div>
        </div>
    </div>

    <div class="column" style="flex: 2;">
        <div class="card" style="flex: 1;">
            <div class="card-title">å…‰ä¼é˜µåˆ—å®æ—¶çŠ¶æ€æ‹“æ‰‘</div>
            
            <div class="legend-bar">
                <div class="legend-item"><div class="dot" style="background:var(--primary-blue)"></div> æ­£å¸¸è¿è¡Œ</div>
                <div class="legend-item"><div class="dot" style="background:var(--warning-orange)"></div> æ²™å°˜æ²‰ç§¯ (éœ€æ¸…æ´—)</div>
                <div class="legend-item"><div class="dot" style="background:var(--danger-red)"></div> ç‰©ç†ç ´æŸ (ç«‹å³ç»´ä¿®)</div>
            </div>

            <div class="grid-wrapper" id="panelGrid"></div>
        </div>
    </div>

    <div class="column">
        <div class="card" style="flex: 1;">
            <div class="card-title">ç³»ç»Ÿä½œä¸šä¸ç»´æŠ¤æ—¥å¿—</div>
            <div class="log-scroll-area">
                <table>
                    <thead>
                        <tr>
                            <th width="45%">ä½œä¸šæ—¥æœŸ/æ—¶é—´</th>
                            <th width="20%">æ‰§è¡Œä¸»ä½“</th>
                            <th>ç»´æŠ¤è¯¦æƒ…</th>
                        </tr>
                    </thead>
                    <tbody id="logBody"></tbody>
                </table>
            </div>
        </div>
    </div>
</main>

<script>
    const logBody = document.getElementById('logBody');
    const clock = document.getElementById('clock');
    const panelGrid = document.getElementById('panelGrid');
    const alertPopup = document.getElementById('alert-popup');
    const botStatus = document.getElementById('bot-status');
    const botBox = document.getElementById('bot-box');

    // è·å–å®Œæ•´æ—¥æœŸæ—¶é—´ YYYY-MM-DD HH:mm:ss
    function getFullDateTime() {
        const now = new Date();
        const y = now.getFullYear();
        const m = String(now.getMonth() + 1).padStart(2, '0');
        const d = String(now.getDate()).padStart(2, '0');
        const hh = String(now.getHours()).padStart(2, '0');
        const mm = String(now.getMinutes()).padStart(2, '0');
        const ss = String(now.getSeconds()).padStart(2, '0');
        return `${y}-${m}-${d} ${hh}:${mm}:${ss}`;
    }

    // æ›´æ–°é¡µå¤´æ—¶é’Ÿ
    setInterval(() => { clock.innerText = getFullDateTime(); }, 1000);

    // åˆå§‹åŒ–é¢æ¿
    for (let i = 1; i <= 100; i++) {
        const p = document.createElement('div');
        const id = 'P-' + String(i).padStart(3, '0');
        p.innerText = id;
        
        if (i % 9 === 0) p.className = 'panel p-dirty';
        else if (i === 15 || i === 42 || i === 88) p.className = 'panel p-error';
        else p.className = 'panel p-normal';

        p.onclick = () => {
            if (p.classList.contains('p-dirty')) handleClean(id, p);
            else if (p.classList.contains('p-error')) handleAlert(id);
            else addLog('æ— äººæœº', `é«˜æ¸…æ‰«æç¡®è®¤ï¼š${id} è¡¨é¢å®Œå¥½æ— æ±¡å¢`);
        };
        panelGrid.appendChild(p);
    }

    function handleClean(id, el) {
        botBox.classList.add('working');
        botStatus.innerText = `æ­£åœ¨å‰å¾€æ¸…ç† #${id}...`;
        botStatus.style.color = 'var(--accent-green)';
        addLog('å±¥å¸¦å°è½¦', `å¯åŠ¨ä¸“é¡¹æ²™å°˜æ¸…ç†ä½œä¸šï¼šé’ˆå¯¹é¢æ¿ ${id}`);
        
        setTimeout(() => {
            el.className = 'panel p-normal';
            botBox.classList.remove('working');
            botStatus.innerText = 'åŸºç«™å¾…å‘½';
            botStatus.style.color = 'inherit';
            addLog('å±¥å¸¦å°è½¦', `é¢æ¿ ${id} æ¸…ç†å®Œæ¯•ï¼Œé€å…‰ç‡å›å‡ã€‚`);
        }, 2000);
    }

    // ä¿®å¤çº¢è‰²å‘Šè­¦
    function handleAlert(id) {
        alertPopup.innerHTML = `
            <div style="font-size: 20px; margin-bottom: 10px;">ğŸ”´ ç´§æ€¥ç»´æŠ¤é€šçŸ¥</div>
            <div style="font-size: 16px;">
                ç³»ç»Ÿæ£€æµ‹åˆ°é¢æ¿ <b>${id}</b> å‘ç”Ÿä¸¥é‡ç‰©ç†æŸåï¼<br>
                åœ°ç†ä½ç½®ï¼šè¥¿åŒ—åŸºåœ° 01åŒº 03æ’<br>
                çŠ¶æ€ï¼š<b>[ä¿¡å·å·²å‘é€]</b> - è‡ªåŠ¨æ´¾å‘ç»´ä¿®å•è‡³ç°åœºç­ç»„
            </div>
        `;
        alertPopup.style.display = 'block';
        addLog('ç³»ç»Ÿä¸­å¿ƒ', `[è­¦æŠ¥] æ£€æµ‹åˆ°ç‰©ç†æŸæ¯ï¼š${id}ï¼Œå·²è§¦å‘è‡ªåŠ¨æ´¾å•æœºåˆ¶`);
        setTimeout(() => { alertPopup.style.display = 'none'; }, 5000);
    }

    function addLog(obj, msg) {
        const tr = document.createElement('tr');
        tr.innerHTML = `
            <td>${getFullDateTime()}</td>
            <td class="log-obj">${obj}</td>
            <td>${msg}</td>
        `;
        logBody.insertBefore(tr, logBody.firstChild);
    }

    // åˆå§‹åŒ–æ—¥å¿—
    addLog('ç³»ç»Ÿä¸­å¿ƒ', 'è¥¿åŒ—åœºç«™ç®¡æ§å¹³å°å¯åŠ¨æˆåŠŸï¼Œå…¨åœºé€šè®¯æ­£å¸¸');
</script>
</body>
</html>